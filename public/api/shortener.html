<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Short URL API</title>

    <!-- Tailwind -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- SweetAlert2 -->
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
  </head>

  <body
    class="bg-gradient-to-r from-blue-900 to-blue-500 min-h-screen flex justify-center items-center"
  >
    <div
      class="bg-white/10 backdrop-blur-md rounded-xl p-6 w-full max-w-xl mx-4 space-y-6 shadow-xl"
    >
      <h1 class="text-white text-4xl font-bold text-center">
        Short URL Generator
      </h1>

      <p class="text-white text-center text-lg">
        Create short links easily using our API
      </p>

      <!-- Input URL -->
      <div class="space-y-2">
        <label class="text-white text-sm">Enter your URL</label>
        <input
          id="urlInput"
          type="url"
          placeholder="https://example.com"
          class="w-full p-3 rounded-lg outline-none focus:ring-2 focus:ring-blue-400"
        />
      </div>

      <!-- Button -->
      <button
        onclick="shortenUrl()"
        class="w-full bg-blue-600 hover:bg-blue-700 text-white py-3 rounded-lg font-semibold transition duration-300"
      >
        Shorten URL
      </button>

      <!-- Result -->
      <div id="result" class="hidden">
        <p class="text-white text-sm mb-2">Short URL</p>
        <div class="flex">
          <input
            id="shortUrl"
            readonly
            class="flex-1 p-3 rounded-l-lg outline-none"
          />
          <button
            onclick="copyUrl()"
            class="bg-green-600 hover:bg-green-700 text-white px-4 rounded-r-lg transition"
          >
            Copy
          </button>
        </div>
      </div>
    </div>

    <script>
      async function shortenUrl() {
        const url = document.getElementById("urlInput").value;
        if (!url) {
          return Swal.fire({
            icon: "warning",
            title: "URL required",
            text: "Please enter a valid URL",
          });
        }

        try {
          const res = await fetch("/api/shorten", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({ url }),
          });

          const data = await res.json();

          if (!res.ok) throw new Error(data.message);

          document.getElementById("shortUrl").value = data.data.shortUrl;
          document.getElementById("result").classList.remove("hidden");

          Swal.fire({
            icon: "success",
            title: "Success!",
            text: "Short URL created successfully",
            timer: 2000,
            showConfirmButton: false,
          });
        } catch (err) {
          Swal.fire({
            icon: "error",
            title: "Error",
            text: err.message || "Something went wrong",
          });
        }
      }

      function copyUrl() {
        const input = document.getElementById("shortUrl");
        input.select();
        document.execCommand("copy");

        Swal.fire({
          toast: true,
          position: "top-end",
          icon: "success",
          title: "Copied to clipboard",
          showConfirmButton: false,
          timer: 2000,
        });
      }
    </script>
  </body>
</html>
